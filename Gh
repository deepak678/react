import json
import re

raw_output = """'''json
{
  "metric": "completeness",
  "query_id": "Q1",
  "total_items": 3,
  "matched_items": 2,
  "final_score": 0.67,
  "details": []
}
'''"""

# 1. Remove triple quotes and optional "json" tag
cleaned = re.sub(r"^```json|^'''json|```$|'''$", "", raw_output.strip(), flags=re.MULTILINE).strip()

# 2. Parse into dict
parsed = json.loads(cleaned)

print(parsed)
print(parsed["final_score"])  # Access values
