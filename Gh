from openpyxl import load_workbook
from collections import Counter
import matplotlib.pyplot as plt

# Load the Excel file
file_path = 'your_file.xlsx'  # Replace with your actual file path
wb = load_workbook(file_path)
ws = wb.active  # Use a specific sheet: wb['SheetName']

# Set the column index to scan (e.g., column B = 2)
column_index = 2

# Count cell fill colors in that column
color_counts = Counter()

for row in ws.iter_rows(min_col=column_index, max_col=column_index):
    for cell in row:
        fill = cell.fill
        if fill and fill.fgColor.type == 'rgb' and fill.fgColor.rgb:
            color_hex = fill.fgColor.rgb[-6:]  # Remove alpha if ARGB
            color_counts[color_hex] += 1

# Plotting the histogram
colors = list(color_counts.keys())
counts = list(color_counts.values())

plt.figure(figsize=(8, 5))
plt.bar(range(len(colors)), counts, color=[f'#{c}' for c in colors])
plt.xticks(range(len(colors)), [f'#{c}' for c in colors])
plt.xlabel('Cell Fill Color (Hex)')
plt.ylabel('Count')
plt.title('Histogram of Highlighted Cells in Column B')
plt.grid(axis='y')
plt.tight_layout()
plt.show()
