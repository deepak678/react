Private Sub Workbook_SheetChange(ByVal Sh As Object, ByVal Target As Range)
    Dim updateTypeColumn As Integer
    updateTypeColumn = 2 ' Assuming "Update Type" column is column 2
    
    ' Check if the change is on a sheet other than "Mapping" and in the specified column
    If Sh.Name <> "Mapping" And Target.Column = updateTypeColumn Then
        Application.EnableEvents = False ' Disable events temporarily
        
        ' Determine the number of operations based on entries in "Update Type" column
        Dim numOperations As Integer
        numOperations = Application.WorksheetFunction.CountA(Sh.Columns(updateTypeColumn)) - 1 ' Subtract header row
        
        ' Insert a new block based on the selected option in the "Update Type" dropdown
        If Target.Cells.Count = 1 Then
            Dim selectedOption As String
            selectedOption = Target.Value
            
            ' Insert a new row for the new block
            Dim newRow As Long
            newRow = Target.Row + 1
            Sh.Rows(newRow).Insert Shift:=xlDown
            
            ' Insert headers for the new block
            Dim headerRow As Long
            headerRow = newRow + 1
            Sh.Cells(headerRow, 1).Value = "No. of Operations " & numOperations & " - Update Type " & selectedOption
            
            ' Add additional headers based on the selected option
            Dim headers As Variant
            Select Case selectedOption
                Case "Option 1"
                    headers = Array("Header A1", "Header A2", "Header A3", "Header A4")
                Case "Option 2"
                    headers = Array("Header B1", "Header B2", "Header B3", "Header B4")
                Case "Option 3"
                    headers = Array("Header C1", "Header C2", "Header C3", "Header C4")
                ' Add more cases as needed
                Case Else
                    ' Default case if none of the above options match
                    headers = Array("Default Header 1", "Default Header 2", "Default Header 3", "Default Header 4")
            End Select
            
            ' Populate headers in the new block
            Dim i As Integer
            For i = LBound(headers) To UBound(headers)
                Sh.Cells(headerRow, i + 2).Value = headers(i)
            Next i
            
            ' Insert a blank row underneath the headers
            Dim newBlockRow As Long
            newBlockRow = headerRow + 1
            Sh.Rows(newBlockRow).Insert Shift:=xlDown
        End If
        
        Application.EnableEvents = True ' Re-enable events
    End If
End Sub
