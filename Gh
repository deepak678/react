import pandas as pd

# Example DataFrames
df1 = pd.DataFrame({
    'title': ['apple', 'banana', 'cherry']
})

df2 = pd.DataFrame({
    'text': ['I love apple pie', 'banana bread is great', 'no fruit here', 'cherry tart'],
    'value': [1, 2, 3, 4]
})

# Result list
results = []

# Loop through titles and match with df2
for title in df1['title']:
    # Find rows where title is a substring of df2['text']
    matched = df2[df2['text'].str.contains(title, case=False, na=False)].copy()
    if not matched.empty:
        matched['matched_title'] = title  # Add the matched title as a new column
        results.append(matched)

# Combine all matched results
final_df = pd.concat(results, ignore_index=True)

print(final_df)
