import pandas as pd
from difflib import get_close_matches

# Step 1: Read the Excel files
df1 = pd.read_excel('file1.xlsx')
df2 = pd.read_excel('file2.xlsx')

# Step 2: Select the columns to compare (replace 'ColumnA' and 'ColumnB' with your actual column names)
col1 = df1['ColumnA']
col2 = df2['ColumnB']

# Step 3: Find closest matches for each value in col1 from col2
matches = []
for value in col1:
    closest = get_close_matches(str(value), col2.astype(str), n=1, cutoff=0)
    if closest:
        matches.append({'ColumnA': value, 'ClosestMatch': closest[0]})
    else:
        matches.append({'ColumnA': value, 'ClosestMatch': None})

# Step 4: Create a new DataFrame with the matches
result_df = pd.DataFrame(matches)

# Optional: Save to Excel or CSV
result_df.to_excel('closest_matches.xlsx', index=False)
