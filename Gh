import pandas as pd

# Load substrings from text file
with open('substrings.txt', 'r') as f:
    substrings = [line.strip().lower() for line in f if line.strip()]

# Load Excel file
df = pd.read_excel('data.xlsx')

# Define the column to search in
target_column = 'Name'  # Change to your column name

# Filter rows where any substring is found in the column
filtered_df = df[df[target_column].astype(str).str.lower().apply(
    lambda x: any(sub in x for sub in substrings)
)]

# Save or print results
filtered_df.to_excel('filtered_rows.xlsx', index=False)
print(filtered_df)
