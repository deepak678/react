import pandas as pd

# Load sheets from Excel
df1 = pd.read_excel("your_file.xlsx", sheet_name="Sheet1")  # contains 'id'
df2 = pd.read_excel("your_file.xlsx", sheet_name="Sheet2")  # contains 'ref_id'

# Convert to sets for matching
set1 = set(df1['id'].dropna())
set2 = set(df2['ref_id'].dropna())

# Find intersection (matching values)
matching_values = set1 & set2  # or use set1.intersection(set2)

# Filter rows in df1 (or df2) with matching values
matched_df1 = df1[df1['id'].isin(matching_values)]
matched_df2 = df2[df2['ref_id'].isin(matching_values)]

# Optional: Merge both matched results (if needed)
result = pd.merge(matched_df1, matched_df2, left_on='id', right_on='ref_id', how='inner')

print("Matched Rows:")
print(result)
