import openpyxl
import matplotlib.pyplot as plt

# Load the workbook and sheet
wb = openpyxl.load_workbook('your_file.xlsx')
sheet = wb.active

# Define color codes for different themes (e.g., theme_7 is lavender, green, etc.)
colors = {
    'Red': 'FF0000',        # Red color
    'Yellow': 'FFFF00',     # Yellow color
    'Green': '00FF00',      # Green color
    'Lavender': 'b1a0c7'    # Lavender color (light purple)
}

# Initialize a dictionary to count occurrences of each color
color_count = {key: 0 for key in colors.keys()}

# Iterate over cells in the specified column (e.g., column A)
for row in sheet.iter_rows(min_col=1, max_col=1):  # Adjust column as necessary
    for cell in row:
        # Compare the background color of the cell with the predefined colors
        for color_name, color_code in colors.items():
            if cell.fill.start_color.index == color_code:
                color_count[color_name] += 1

# Print the color counts
print(f"Color counts: {color_count}")

# Plot a histogram of the color counts
plt.bar(color_count.keys(), color_count.values(), color=['red', 'yellow', 'green', 'lavender'])
plt.title('Histogram of Highlighted Cells')
plt.xlabel('Colors')
plt.ylabel('Frequency')
plt.show()
