import re
import ast

def extract_title_description(text):
    # Fix to make the string valid for parsing
    text = '{' + text + '}'
    
    # Replace smart commas (optional safety)
    text = text.replace("“", "\"").replace("”", "\"")

    # Try to parse as a Python dict with escaped quotes
    try:
        # Safely evaluate the string into a dictionary
        parsed = ast.literal_eval(text)
        return pd.Series([parsed.get("title", ""), parsed.get("description", "")])
    except Exception as e:
        print("Error parsing:", text)
        return pd.Series(["", ""])

# Apply to DataFrame
df[['title', 'description']] = df['raw_text'].apply(extract_title_description)

print(df[['title', 'description']])
