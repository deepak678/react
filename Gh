import pandas as pd

# Load both Excel files
df_large = pd.read_excel("large_file.xlsx")   # 17,936 rows
df_small = pd.read_excel("small_file.xlsx")   # 285 rows

# Set column names correctly
large_column = "LargeText"    # replace with your actual column name
small_column = "SearchTerm"   # replace with your actual column name

# Ensure text format
df_large[large_column] = df_large[large_column].astype(str).str.lower()
df_small[small_column] = df_small[small_column].astype(str).str.lower()

# Store matches
matches = []

# Check for substring containment
for idx, small_value in df_small[small_column].items():
    for large_idx, large_text in df_large[large_column].items():
        if small_value in large_text:
            matches.append({
                "SearchTerm": small_value,
                "MatchedText": large_text,
                "LargeFile_RowIndex": large_idx
            })

# Convert to DataFrame and save
matches_df = pd.DataFrame(matches)
matches_df.to_excel("substring_matches.xlsx", index=False)
