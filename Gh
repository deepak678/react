Function TableExists(sheet As Worksheet, tableName As String) As Boolean
    Dim tbl As ListObject
    On Error GoTo NoTables
    
    ' Loop through each table in the sheet
    For Each tbl In sheet.ListObjects
        If tbl.Name = tableName Then
            TableExists = True
            Exit Function
        End If
    Next tbl
    
    TableExists = False
    Exit Function

NoTables:
    ' No tables on the sheet
    TableExists = False
End Function
