import pandas as pd
from collections import OrderedDict

# Load the Excel file
file_path = '/mnt/data/your_excel_file.xlsx'  # Update this with the correct path to your Excel file

# Read the entire sheet
df = pd.read_excel(file_path, sheet_name=0, header=None)

# Function to identify headers and extract tables
def extract_tables(df):
    tables = OrderedDict()
    current_table_name = None
    current_table_data = []
    is_collecting_data = False

    for i, row in df.iterrows():
        if pd.isnull(row[0]):
            if is_collecting_data:
                # Collect data only if we're in the middle of a table
                if not pd.isnull(row[1]):  # Only add rows with non-null second column
                    current_table_data.append([row[1], row[2]])  # Skip the serial number and take the next two columns
        else:
            # We've encountered a potential table header
            if current_table_name:
                # Save the previous table
                tables[current_table_name] = current_table_data
            # Start a new table
            current_table_name = row[0]
            current_table_data = []
            is_collecting_data = True  # Start collecting data for the new table

    # Append the last table
    if current_table_name:
        tables[current_table_name] = current_table_data

    return tables

# Extract tables
tables = extract_tables(df)

# Print the result
for table_name, table_data in tables.items():
    print(f"{table_name}:")
    for row in table_data:
        print(row)
